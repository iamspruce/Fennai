---
import ProfileHeader from "@/components/profile/ProfileHeader.astro";
import ProfileGreeting from "@/components/profile/ProfileGreeting.astro";
import CharactersSection from "@/components/profile/CharactersSection.astro";

// 1. MOCK DATA - Matches the structure your components expect
const mockUser = {
    displayName: "Fennai Demo",
    credits: 850,
    avatarUrl: "https://api.dicebear.com/7.x/avataaars/svg?seed=Felix",
};

// 2. MOCK CHARACTERS - Using your specific "/sample-output.wav"
const mockCharacters = [
    {
        id: "char_demo_1",
        name: "Aelthos the Brave",
        avatarUrl: "https://api.dicebear.com/7.x/adventurer/svg?seed=Aelthos",
        createdAt: new Date("2023-11-15"),
        voiceCount: 42,
        sampleAudioUrl: "/sample-output.wav", // Your specific audio file
    },
    {
        id: "char_demo_2",
        name: "Lyra Shadowstep",
        avatarUrl: "https://api.dicebear.com/7.x/adventurer/svg?seed=Lyra",
        createdAt: new Date("2023-12-01"),
        voiceCount: 128,
        sampleAudioUrl: "/sample-output.wav",
    },
    {
        id: "char_demo_3",
        name: "Cyber Punk Unit",
        avatarUrl: "https://api.dicebear.com/7.x/bottts/svg?seed=Cyber",
        createdAt: new Date("2024-01-10"),
        voiceCount: 15,
        sampleAudioUrl: "/sample-output.wav",
    },
];

const mockGreeting = "Good Afternoon, Fennai";
---

<div class="preview-scene">
    <div class="mobile-device">
        <div class="device-notch-bar">
            <span class="time">9:41</span>
            <div class="notch"></div>
            <span class="battery">100%</span>
        </div>

        <div class="app-content">
            <div class="header-wrapper">
                <ProfileHeader
                    userAvatarUrl={mockUser.avatarUrl}
                    userName={mockUser.displayName}
                    credits={mockUser.credits}
                />
            </div>

            <main class="main-content">
                <ProfileGreeting greeting={mockGreeting} />

                <CharactersSection
                    characters={mockCharacters}
                    characterLimit={5}
                />
            </main>
        </div>
    </div>
</div>

<style is:global>
    .preview-scene {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 4rem 2rem;
        perspective: 1200px;
        overflow: visible;
    }

    .mobile-device {
        width: 375px;
        height: 700px;
        background: var(--background-color, #ffffff); /* Matches your theme */
        border-radius: 40px;

        /* The 3D Slant Transformation */
        transform: rotateY(-15deg) rotateX(10deg) rotateZ(-2deg);
        transform-style: preserve-3d;

        /* Box Shadow for floating effect */
        box-shadow:
            -30px 40px 60px -10px rgba(0, 0, 0, 0.3),
            /* Deep shadow */ inset 0 0 0 4px #e2e8f0; /* Bezel look */

        position: relative;
        transition: transform 0.4s ease;
        overflow: hidden; /* Clips content to rounded corners */
        border: 8px solid #1a1a1a; /* Dark bezel border */
    }

    /* Interactive Hover Effect: Straighten slightly on hover */
    .mobile-device:hover {
        transform: rotateY(0deg) rotateX(0deg) rotateZ(0deg) scale(1.02);
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        z-index: 10;
    }

    /* 3. INTERNAL LAYOUT */
    .app-content {
        height: 100%;
        overflow-y: auto; /* Allow scrolling inside the phone */
        padding: 20px;
        background: var(--mauve-1, #fcfcfc); /* Ensure background is set */
        scrollbar-width: none; /* Hide scrollbar for cleaner look */
    }
    .app-content::-webkit-scrollbar {
        display: none;
    }

    .header-wrapper {
        margin-bottom: 2rem;
    }

    /* Fake Status Bar */
    .device-notch-bar {
        display: flex;
        justify-content: space-between;
        padding: 12px 24px 0;
        font-size: 12px;
        font-weight: 600;
        color: #333;
        background: var(--mauve-1, #fcfcfc);
        position: relative;
        z-index: 20;
    }
    .notch {
        width: 100px;
        height: 20px;
        background: #1a1a1a;
        border-bottom-left-radius: 12px;
        border-bottom-right-radius: 12px;
        position: absolute;
        left: 50%;
        top: 0;
        transform: translateX(-50%);
    }

    /* Dark Mode Adjustment (Optional) */
    :global(.dark) .mobile-device {
        border-color: #333;
        background: #000;
        box-shadow: -30px 40px 60px -10px rgba(0, 0, 0, 0.6);
    }
    :global(.dark) .app-content,
    :global(.dark) .device-notch-bar {
        background: #111;
        color: #fff;
    }
</style>
