---
import BaseLayout from "../layouts/BaseLayout.astro";
import ProfilePreview from "@/components/ui/ProfilePreview.astro";
import LoginModal from "../islands/LoginModal";
import { getCurrentUser } from "../lib/firebase/auth";

const user = await getCurrentUser(Astro);
if (user) {
	return Astro.redirect("/profile");
}
---

<BaseLayout title="Fennai - Voice Cloning Made Simple">
	<div class="page-modal">
		<header class="home-header">
			<div class="logo">
				<svg
					width="40"
					height="40"
					viewBox="0 0 40 40"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<circle cx="20" cy="20" r="20" fill="var(--pink-9)"
					></circle>
					<path d="M15 14L25 20L15 26V14Z" fill="white"></path>
				</svg>
				<span class="logo-text">Fennai</span>
			</div>

			<button class="btn-login" id="open-login"> Login / Sign Up </button>
		</header>

		<main class="home-main">
			<h1 class="hero-title">
				<span class="text-avatars">Voice cloning should not be</span>
				<span class="text-video">rocket science.</span>
			</h1>

			<div class="demo-perspective-wrapper">
				<div class="demo-tilt-container">
					<ProfilePreview />
				</div>
			</div>
		</main>

		<footer class="home-footer">
			<div class="footer-content">
				<p class="copyright">Â© 2025 Fennai. All rights reserved.</p>
				<div class="footer-links">
					<a href="#">Privacy</a>
					<a href="#">Terms</a>
					<a href="#">Contact</a>
				</div>
			</div>
		</footer>
	</div>

	<LoginModal client:load />
</BaseLayout>

<script>
	const openButton = document.getElementById("open-login");
	if (openButton) {
		openButton.addEventListener("click", () => {
			window.dispatchEvent(new CustomEvent("open-login-modal"));
		});
	}
</script>

<style>
	/* --- HEADER STYLES --- */
	.home-header {
		display: flex;
		align-items: center;
		justify-content: space-between;
		padding: var(--space-3xs) 0;
	}

	.logo {
		display: flex;
		align-items: center;
		gap: var(--space-2xs);
	}

	.logo-text {
		font-size: var(--step-1);
		font-weight: 700;
		letter-spacing: -0.02em;
		color: var(--mauve-12);
	}

	.btn-login {
		background: var(--mauve-12);
		color: var(--mauve-1);
		border: none;
		padding: 12px 28px;
		border-radius: 99px;
		font-weight: 600;
		font-size: var(--step-0);
		cursor: pointer;
		transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
	}
	.btn-login:hover {
		transform: translateY(-2px);
		box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
	}

	/* --- HERO TYPOGRAPHY --- */
	.home-main {
		text-align: center;
		padding: var(--space-s) 0;
	}

	.hero-title {
		font-size: calc(var(--step-5) * 2); /* Very large text */
		font-weight: 800;
		line-height: 1.1;
		letter-spacing: -0.04em;
		margin-top: var(--space-2xl);
		margin-bottom: var(--space-s);
		display: flex;
		flex-direction: column;
		align-items: center;

		/* Apply animated background to entire title */
		background-image: url("https://media.giphy.com/media/l0HlNQ03J5JxX6lva/giphy.gif");
		background-size: cover;
		background-position: center;
		-webkit-background-clip: text;
		background-clip: text;
		color: transparent;
	}

	/* Remove separate text effect classes */
	.text-avatars,
	.text-video {
		/* Inherit from parent */
	}

	.hero-subtitle {
		font-size: var(--step-2);
		color: var(--mauve-11);
		max-width: 600px;
		margin: 0 auto;
		line-height: 1.5;
		font-weight: 400;
	}

	/* --- 3D PREVIEW SECTION --- */
	.demo-perspective-wrapper {
		margin-top: 6rem;
		width: 100%;
		display: flex;
		justify-content: center;
		perspective: 2000px;
	}

	.demo-tilt-container {
		transform: rotateX(15deg) rotateZ(-3deg) rotateY(8deg);
		transform-style: preserve-3d;
		transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
		filter: drop-shadow(0 30px 60px rgba(0, 0, 0, 0.3));
	}

	.demo-perspective-wrapper:hover .demo-tilt-container {
		transform: rotateX(8deg) rotateZ(-1deg) rotateY(4deg) scale(1.02);
		filter: drop-shadow(0 40px 80px rgba(0, 0, 0, 0.4));
	}

	/* --- FOOTER --- */
	.home-footer {
		margin-top: 8rem;
		border-top: 1px solid var(--mauve-6);
		padding: var(--space-l) 0 var(--space-xl) 0;
	}

	.footer-content {
		display: flex;
		justify-content: space-between;
		align-items: center;
	}

	.copyright {
		color: var(--mauve-10);
		font-size: var(--step--1);
	}

	.footer-links {
		display: flex;
		gap: var(--space-m);
	}

	.footer-links a {
		color: var(--mauve-11);
		text-decoration: none;
		font-size: var(--step-0);
		transition: color 0.2s;
	}

	.footer-links a:hover {
		color: var(--mauve-12);
	}

	@media (max-width: 768px) {
		.footer-content {
			flex-direction: column;
			gap: var(--space-m);
		}
		.demo-tilt-container {
			/* Less tilt on mobile to preserve readability */
			transform: rotateX(10deg);
		}
	}
</style>
